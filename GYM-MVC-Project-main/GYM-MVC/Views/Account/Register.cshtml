@using GYM_MVC.ViewModels.AccountViewModels
@model RegisterMemberViewModel
@{
    ViewData["Title"] = "Register";
    Layout = "_AuthLayout";
}

<form asp-action="RegisterTheMember" class="register-form" enctype="multipart/form-data">
    <div class="d-flex justify-content-center my-2">
        <div class="profile-upload-container">
            <div class="profile-upload">
                <img id="profilePreview" src="~/images/DefImage.jpg"
                     class="profile-preview" alt="Profile Preview" />
                <label for="imageUpload" class="upload-label">
                    <div class="upload-overlay"><i class="fas fa-camera"></i></div>
                </label>
                <input type="file" id="imageUpload" asp-for="Image" accept="image/*"
                       class="visually-hidden" onchange="previewImage(event)" />
            </div>
        </div>
    </div>

    <div class="split-container">
        <div class="split-left">
            <div class="form-section">
                <h3 class="section-title"><i class="fas fa-user mr-2"></i>Personal Information</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label asp-for="MemberName" class="form-label">Full Name</label>
                        <input asp-for="MemberName" class="form-control" placeholder="Enter your full name" />
                        <span asp-validation-for="MemberName" class="field-validation-error"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="BirthDate" class="form-label">Birth Date</label>
                        <input asp-for="BirthDate" type="date" class="form-control" />
                        <span asp-validation-for="BirthDate" class="field-validation-error"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="PhoneNumber" class="form-label">Phone Number</label>
                        <input asp-for="PhoneNumber" class="form-control" placeholder="Enter your phone number" />
                        <span asp-validation-for="PhoneNumber" class="field-validation-error"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="MaterialStatus" class="form-label">Marital Status</label>
                        <select asp-for="MaterialStatus" class="form-control">
                            <option value="">Select marital status</option>
                            <option value="Single">Single</option>
                            <option value="Married">Married</option>
                        </select>
                        <span asp-validation-for="MaterialStatus" class="field-validation-error"></span>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h3 class="section-title"><i class="fas fa-heartbeat mr-2"></i>Health Information</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label asp-for="Weight" class="form-label">Weight (kg)</label>
                        <input asp-for="Weight" class="form-control" placeholder="Enter your weight" />
                        <span asp-validation-for="Weight" class="field-validation-error"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="Height" class="form-label">Height (cm)</label>
                        <input asp-for="Height" class="form-control" placeholder="Enter your height" />
                        <span asp-validation-for="Height" class="field-validation-error"></span>
                    </div>

                    <div class="form-group full-width">
                        <label asp-for="Illnesses" class="form-label">Any Illnesses (if applicable)</label>
                        <input asp-for="Illnesses" class="form-control" placeholder="List any illnesses" />
                        <span asp-validation-for="Illnesses" class="field-validation-error"></span>
                    </div>

                    <div class="form-group full-width">
                        <label asp-for="Injuries" class="form-label">Any Injuries (if applicable)</label>
                        <input asp-for="Injuries" class="form-control" placeholder="List any injuries" />
                        <span asp-validation-for="Injuries" class="field-validation-error"></span>
                    </div>

                    <div class="form-group full-width">
                        <label asp-for="AvailableDays" class="form-label">Available Days</label>
                        <input asp-for="AvailableDays" class="form-control" placeholder="Available Days Per Week" />
                        <span asp-validation-for="AvailableDays" class="field-validation-error"></span>
                    </div>
                    <div class="form-group full-width">
                        <label asp-for="SleepHours" class="form-label">Sleep Hours</label>
                        <input asp-for="SleepHours" class="form-control" placeholder="Sleep Hours" />
                        <span asp-validation-for="SleepHours" class="field-validation-error"></span>
                    </div>

                    <div class="form-section">
                        <h3 class="section-title"><i class="fas fa-lock mr-2"></i>Account Information</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label asp-for="Name" class="form-label">Username</label>
                                <input asp-for="Name" class="form-control" placeholder="Choose a username" />
                                <span asp-validation-for="Name" class="field-validation-error"></span>
                            </div>

                            <div class="form-group">
                                <label asp-for="Email" class="form-label">Email</label>
                                <input asp-for="Email" class="form-control" placeholder="Enter your email" />
                                <span asp-validation-for="Email" class="field-validation-error"></span>
                            </div>

                            <div class="form-group password-input">
                                <label asp-for="Password" class="form-label">Password</label>
                                <input asp-for="Password" type="password" class="form-control" placeholder="Create a password" />
                                <span class="toggle-password" onclick="togglePasswordVisibility(this)"><i class="fas fa-eye"></i></span>
                                <span asp-validation-for="Password" class="field-validation-error"></span>
                            </div>

                            <div class="form-group password-input">
                                <label asp-for="ConfirmPassword" class="form-label">Confirm Password</label>
                                <input asp-for="ConfirmPassword" type="password" class="form-control" placeholder="Confirm your password" />
                                <span class="toggle-password" onclick="togglePasswordVisibility(this)"><i class="fas fa-eye"></i></span>
                                <span asp-validation-for="ConfirmPassword" class="field-validation-error"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="split-right">
            <div class="form-section">
                <h3 class="section-title"><i class="fas fa-dumbbell mr-2"></i>Select Your Trainer</h3>
                <div class="trainer-selection">
                    <div class="trainer-grid">
                        @if (Model?.AvailableTrainers != null)
                        {
                            foreach (var trainer in Model.AvailableTrainers)
                            {
                                <label for="trainer-@trainer.Id" class="trainer-radio-wrapper">
                                    <input type="radio" name="SelectedTrainerId" value="@trainer.Id"
                                           id="trainer-@trainer.Id" class="visually-hidden"
                                    @(Model.SelectedTrainerId == trainer.Id ? "checked" : "") />
                                    <div class="trainer-card @(Model.SelectedTrainerId == trainer.Id ? "selected" : "")">
                                        <div class="trainer-badge"><i class="fas fa-check"></i></div>
                                        <img src="@trainer.ImagePath" class="trainer-thumbnail" alt="@trainer.Name" />
                                        <div class="trainer-details">
                                            <h6 class="trainer-name">@trainer.Name</h6>
                                            <p class="trainer-specialty">@trainer.Specialty</p>
                                        </div>
                                    </div>
                                </label>
                            }
                        }
                    </div>
                    <span asp-validation-for="SelectedTrainerId" class="field-validation-error"></span>
                </div>
            </div>

            <div class="form-section">
                <h3 class="section-title"><i class="fas fa-id-card mr-2"></i>Choose Your Membership</h3>
                <div class="membership-selection">
                    <div class="membership-grid">
                        @if (Model.AvailableMemberships != null)
                        {
                            foreach (var membership in Model.AvailableMemberships)
                            {
                                <label for="membership-@membership.Id" class="membership-radio-wrapper">
                                    <input type="radio" name="SelectedMembershipId" value="@membership.Id"
                                           id="membership-@membership.Id" class="visually-hidden"
                                    @(Model.SelectedMembershipId == membership.Id ? "checked" : "") />
                                    <div class="membership-card @(Model.SelectedMembershipId == membership.Id ? "selected" : "")">
                                        <div class="membership-badge"><i class="fas fa-check"></i></div>
                                        <div class="membership-header">
                                            <h4>@membership.SelectedMembershipType</h4>
                                        </div>
                                        <div class="membership-price">
                                            $@membership.Price <span>/month</span>
                                        </div>
                                        <div class="membership-features">
                                            @membership.Description
                                        </div>
                                    </div>
                                </label>
                            }
                        }
                    </div>
                    <span asp-validation-for="SelectedMembershipId" class="field-validation-error"></span>
                </div>
            </div>

         

            <div class="form-actions">
                <button type="submit" class="btn btn-register">
                    <i class="fas fa-user-plus mr-2"></i> Register Now
                </button>
                <div class="auth-links">
                    Already have an account? <a asp-action="Login">Sign in</a>
                </div>
            </div>
        </div>
    </div>
</form>

@section Scripts {
    <script>
        function previewImage(event) {
            const reader = new FileReader();
            reader.onload = function () {
                const preview = document.getElementById('profilePreview');
                preview.src = reader.result;
                preview.classList.add('upload-animation');
                setTimeout(() => preview.classList.remove('upload-animation'), 500);
            };
            if (event.target.files[0]) reader.readAsDataURL(event.target.files[0]);
        }

        function togglePasswordVisibility(icon) {
            const input = icon.parentElement.querySelector('input');
            const eyeIcon = icon.querySelector('i');
            if (input.type === 'password') {
                input.type = 'text';
                eyeIcon.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                input.type = 'password';
                eyeIcon.classList.replace('fa-eye-slash', 'fa-eye');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.trainer-radio-wrapper input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    document.querySelectorAll('.trainer-card').forEach(card => card.classList.remove('selected'));
                    radio.closest('.trainer-radio-wrapper').querySelector('.trainer-card').classList.add('selected');
                });
            });

            document.querySelectorAll('.membership-radio-wrapper input[type="radio"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    document.querySelectorAll('.membership-card').forEach(card => card.classList.remove('selected'));
                    radio.closest('.membership-radio-wrapper').querySelector('.membership-card').classList.add('selected');
                });
            });

            const firstInput = document.querySelector('input:not([type="hidden"]):not([type="file"]):not([type="radio"])');
            if (firstInput) firstInput.focus();
        });
    </script>
}

<style>
    .trainer-card.selected,
    .membership-card.selected {
        border: 2px solid var(--primary, #ff6b6b);
        box-shadow: 0 0 8px rgba(255, 107, 107, .4);
    }
</style>
